<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
  <title>问卷调查</title>

  <!-- ===== 样式（已解码，保留全部动效） ===== -->
  <style>
    :root{--btn-bg:#c9b7fb;--btn-hover:#b19bff;}
    body{margin:0;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:#f5f5f7;display:flex;justify-content:center;align-items:center;min-height:100vh;}
    .ui-btn{margin-top:20px;border:none;border-radius:12px;background:var(--btn-bg);color:#fff;font-size:16px;font-weight:600;padding:12px 28px;cursor:pointer;transition:background .3s;}
    .ui-btn:hover{background:var(--btn-hover);}
    /* 输入框贴边 */
    .input-container{width:100%;box-sizing:border-box;padding:0 2px;}
    #answer{width:100%;padding:14px 18px;border:2px solid #e0e0e0;border-radius:12px;font-size:16px;transition:border-color .3s;box-sizing:border-box;transform:scale(.8);opacity:0;}
    #answer.animate{animation:scaleIn .5s forwards;}
    @keyframes scaleIn{to{transform:scale(1);opacity:1;}}
    @keyframes shake{0%,100%{transform:translateX(0);}25%{transform:translateX(-6px);}75%{transform:translateX(6px);}}
    .shake{animation:shake .3s 2;}
    .container{background:#fff;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.1);padding:40px;width:90%;max-width:500px;text-align:center;}
    #question{font-size:24px;color:#333;margin-bottom:25px;font-weight:600;}
    .youscreen{position:fixed;inset:0;background:#ffcad382;display:none;flex-direction:column;align-items:center;justify-content:center;}
    .yes-text{font-size:7vw;color:#6c5ce7;margin-bottom:30px;}
    .yes-image{max-width:80%;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.2);}
    .popup{position:fixed;inset:0;background:rgba(0,0,0,.45);display:flex;align-items:center;justify-content:center;z-index:9999;}
    .popup-box{background:#fff;border:2px solid #ead9ff;padding:30px;border-radius:20px;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,.2);max-width:90%;}
    /* 病娇特效 */
    .blood-rain{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9998;}
    .blood-drop{position:absolute;width:2px;height:25px;background:#c70000;opacity:.7;animation:fall 1s linear infinite;}
    @keyframes fall{to{transform:translateY(120vh);}}
    .blood-splatter{position:absolute;width:8px;height:8px;background:#c70000;border-radius:50%;opacity:.8;animation:splat .4s ease-out forwards;}
    @keyframes splat{to{transform:scale(3);opacity:0;}}
    .blood-text{position:fixed;color:#c70000;font-weight:700;z-index:9999;animation:fade 8s forwards;}
    @keyframes fade{0%{opacity:0;transform:translateY(0);}10%{opacity:1;}100%{opacity:0;transform:translateY(30px);}}
    .retry-text{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;border:2px solid #c70000;border-radius:12px;padding:15px 25px;font-size:18px;color:#c70000;z-index:10000;box-shadow:0 0 20px rgba(199,0,0,.35);}
    body.blood-mode{filter:grayscale(80%) hue-rotate(120deg);}
  </style>
</head>

<body>
  <audio id="music" src="music/music.mp3"></audio>
  <audio id="musichp" src="music/music2.mp3" loop></audio>

  <div class="container">
    <div id="question"></div>
    <div class="input-container">
      <input type="text" id="answer" autocomplete="off" placeholder="请输入你的答案...">
    </div>
    <button id="nextBtn" class="ui-btn">下一个</button>
  </div>

  <div class="youscreen">
    <h1 class="yes-text">我也喜欢你~</h1>
    <img src="picture/gif.gif" alt="HAPI" class="yes-image">
  </div>

  <div class="popup" id="welcomePopup">
    <div class="popup-box">
      一定要说真话哦<br/>......<br/>最喜欢你了
      <br><br>
      <button class="ui-btn" onclick="closeWelcome()">关闭</button>
    </div>
  </div>

  <script>
    /* ===== 配置 ===== */
    const messagest   = "一定要说真话哦<br/>......<br/>最喜欢你了";
    const answerst    = "你<br/>喜欢你<br/>是你<br/>you";
    const questionst  = "最喜欢的歌是什么?<br/>最喜欢的食物是什么?<br/>最喜欢的颜色是哪个?<br/>最喜欢的季节是什么?<br/>最喜欢的动物是什么?<br/>最喜欢的人是谁?";
    const textst      = "为什么不填我<br/>要永远在一起啊<br/>看着我...只准看着我<br/>我一直注视着你<br/>拒绝是新型的告白对吧对吧<br/>为什么要逃呢<br/>我知道你喜欢我的 对吧<br/>好痛...但更痛的是心";
    const textstw     = "哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈<br/>我最愛你了....<br/>你以为你能逃得掉吗<br/>没用的...没用的...没用的...<br/>一切都已经太迟了<br/>只准喜歡我....<br/>我們註定是要在一起的<br/>爱你...你...爱...爱你...";
    const opportunity = "再给你一次机会";

    /* ===== 基础变量 ===== */
    const questions   = questionst.split('<br/>');
    let   currentStep = 0;
    const music       = document.getElementById('music');
    const musichp     = document.getElementById('musichp');

    /* ===== 交互控制 ===== */
    window.addEventListener('load', () => {
      document.getElementById('welcomePopup').style.display = 'flex';
    });
    function closeWelcome(){
      document.getElementById('welcomePopup').style.display = 'none';
      document.getElementById('answer').classList.add('animate');
    }
    function updateQuestion(){
      document.getElementById('question').textContent = questions[currentStep];
      document.getElementById('answer').value = '';
      document.getElementById('answer').focus();
    }
      document.getElementById('nextBtn').addEventListener('click', () => {
        const val = document.getElementById('answer').value.trim();
        if (!val) {
        alert('请输入答案！');
    return;
    }
       if (currentStep === questions.length - 1) {
       checkFinalAnswer(val);
    return;
    }
  currentStep++;
  updateQuestion();
});
    function checkFinalAnswer(val) {
      const ok = answerst.split('<br/>').some(v => val.toLowerCase().includes(v.toLowerCase()));
      if (ok) {
        document.querySelector('.container').style.display = 'none';
        document.querySelector('.youscreen').style.display = 'flex';
        musichp.play();
      } else {
        triggerApocalypse();
      }
    }
    updateQuestion();

    /* ===== 病娇特效（完整还原） ===== */
    let retryCount = 0;
    let isApocalypse = false;
    let bloodTimerIDs = [];

    function triggerApocalypse() {
      music.play();
      isApocalypse = true;
      document.body.classList.add('blood-mode');

      /* 血雨 DOM */
      const rainBox = document.createElement('div');
      rainBox.className = 'blood-rain';
      document.body.appendChild(rainBox);

      /* 血雨定时器 */
      const rainID = setInterval(() => {
        const drop = document.createElement('div');
        drop.className = 'blood-drop';
        drop.style.left = Math.random() * 100 + '%';
        drop.style.animationDuration = (Math.random() * 0.5 + 0.5) + 's';
        rainBox.appendChild(drop);
        setTimeout(() => drop.remove(), 1000);
      }, 30);
      bloodTimerIDs.push(rainID);

      /* 血字 + 血点 */
      const texts = textstw.split('<br/>');
      const textID = setInterval(() => {
        if (!isApocalypse) return;
        const t = document.createElement('div');
        t.className = 'blood-text';
        t.style.left = Math.random() * 90 + '%';
        t.style.top = Math.random() * 90 + '%';
        t.style.fontSize = (Math.random() * 10 + 18) + 'px';
        t.textContent = texts[Math.floor(Math.random() * texts.length)];
        document.body.appendChild(t);
        setTimeout(() => t.remove(), 8000);
      }, 400);
      bloodTimerIDs.push(textID);

      /* 10 秒后停音乐、清场、显示“再给你一次机会” */
      setTimeout(() => {
        clearInterval(rainID);
        clearInterval(textID);
        music.pause();
        music.currentTime = 0;
        rainBox.remove();
        document.body.classList.remove('blood-mode');
        document.querySelectorAll('.blood-text,.blood-splatter').forEach(el => el.remove());

        /* 再给你一次机会弹窗 */
        const retry = document.createElement('div');
        retry.className = 'retry-text';
        retry.textContent = opportunity;
        document.body.appendChild(retry);
        setTimeout(() => retry.remove(), 2000);

        /* 恢复可交互 */
        retryCount++;
        updateQuestion();
        isApocalypse = false;
      }, 10000);
    }
  </script>
</body>
</html>
