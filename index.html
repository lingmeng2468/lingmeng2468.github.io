<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
  <title>问卷调查</title>

  <!-- 样式 -->
  <style>
    /* 弹窗遮罩 */
    .popup{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.45);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:9999;
    }
    .popup-box{
      background:#fff;
      border:2px solid #ead9ff;
      padding:30px;
      border-radius:20px;
      text-align:center;
      box-shadow:0 10px 30px rgba(0,0,0,.2);
      max-width:90%;
    }

    /* 其它沿用你原来的 */
    body{
      font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
      background:#f5f5f7;
      margin:0;
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
    }
    .container{
      background:#fff;
      border-radius:20px;
      box-shadow:0 10px 30px rgba(0,0,0,.1);
      padding:40px;
      width:90%;
      max-width:500px;
      text-align:center;
    }
    #question{font-size:24px;color:#333;margin-bottom:30px;font-weight:600;}
    #answer{
      width:100%;
      padding:15px 20px;
      border:2px solid #e0e0e0;
      border-radius:12px;
      font-size:16px;
      transition:all .3s ease;
      transform:scale(.8);
      opacity:0;
    }
    #answer.animate{animation:scaleIn .5s ease-out forwards;}
    @keyframes scaleIn{
      from{transform:scale(.8);opacity:0;}
      to{transform:scale(1);opacity:1;}
    }
    #nextBtn{
      background:#c9b7fb;
      color:#fff;
      border:none;
      padding:15px 30px;
      border-radius:12px;
      font-size:16px;
      font-weight:600;
      cursor:pointer;
      width:100%;
      margin-top:20px;
    }
    #nextBtn:hover{background:#b19bff;}
    .youscreen{
      position:fixed;
      inset:0;
      background:#ffcad382;
      display:none;
      flex-direction:column;
      align-items:center;
      justify-content:center;
    }
    .yes-text{font-size:7vw;color:#6c5ce7;margin-bottom:30px;}
    .yes-image{max-width:80%;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.2);}
  </style>
</head>

<body>
  <!-- 音频 -->
  <audio id="music" src="music/music.mp3"></audio>
  <audio id="musichp" src="music/music2.mp3" loop></audio>

  <!-- 问卷主体 -->
  <div class="container">
    <div id="question"></div>
    <div class="input-container">
      <input type="text" id="answer" autocomplete="off" placeholder="请输入你的答案...">
    </div>
    <button onclick="nextQuestion()" id="nextBtn">下一个</button>
  </div>

  <!-- 成功页 -->
  <div class="youscreen">
    <h1 class="yes-text">我也喜欢你~</h1>
    <img src="picture/gif.gif" alt="HAPI" class="yes-image">
  </div>

  <!-- 弹窗（默认隐藏） -->
  <div class="popup" id="welcomePopup" style="display:none">
    <div class="popup-box">
      一定要说真话哦<br/>......<br/>最喜欢你了
      <br><br>
      <button onclick="closeWelcome()">关闭</button>
    </div>
  </div>

  <!-- 逻辑 -->
  <script>
    /* ====== 配置 ====== */
    const messagest   = "一定要说真话哦<br/>......<br/>最喜欢你了";
    const answerst    = "你<br/>喜欢你<br/>是你<br/>you";
    const questionst  = "最喜欢的歌是什么?<br/>最喜欢的食物是什么?<br/>最喜欢的颜色是哪个?<br/>最喜欢的季节是什么?<br/>最喜欢的动物是什么?<br/>最喜欢的人是谁?";
    const textst      = "为什么不填我<br/>要永远在一起啊<br/>看着我...只准看着我<br/>我一直注视着你<br/>拒绝是新型的告白对吧对吧<br/>为什么要逃呢<br/>我知道你喜欢我的 对吧<br/>好痛...但更痛的是心";
    const textstw     = "哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈<br/>我最愛你了....<br/>你以为你能逃得掉吗<br/>没用的...没用的...没用的...<br/>一切都已经太迟了<br/>只准喜歡我....<br/>我們註定是要在一起的<br/>爱你...你...爱...爱你...";
    const opportunity = "再给你一次机会";

    /* ====== 初始化 ====== */
    const questions   = questionst.split('<br/>');
    let   currentStep = 0;
    const music       = document.getElementById('music');
    const musichp     = document.getElementById('musichp');

    /* 等待所有资源加载完再显示弹窗 */
    window.addEventListener('load', () => {
      document.getElementById('welcomePopup').style.display = 'flex';
    });
    function closeWelcome(){
      document.getElementById('welcomePopup').style.display = 'none';
      document.getElementById('answer').classList.add('animate');
    }

    /* ====== 问卷流程 ====== */
    function updateQuestion(){
      document.getElementById('question').textContent = questions[currentStep];
      document.getElementById('answer').value = '';
      document.getElementById('answer').focus();
    }
    function nextQuestion(){
      if (currentStep === questions.length - 1){
        checkFinalAnswer();
        return;
      }
      currentStep++;
      updateQuestion();
    }
    function checkFinalAnswer(){
      const val = document.getElementById('answer').value.trim().toLowerCase();
      const ok  = answerst.split('<br/>').some(v=>val.includes(v.toLowerCase()));
      if (ok){
        /* 成功分支 */
        document.querySelector('.container').style.display = 'none';
        document.querySelector('.youscreen').style.display = 'flex';
        musichp.play();
      }else{
        /* 失败分支：简单闪红即可，别用死循环 */
        document.body.style.animation = 'shake .3s 2';
        setTimeout(()=> document.body.style.animation='',600);
      }
    }
    updateQuestion();
  </script>
</body>
</html>
